 <main class="flex-1 pb-8 h-screen">
    <div class="max-w-full mx-auto mt-20 px-4 text-lg leading-6 font-medium text-gray-900 sm:px-6 lg:px-8 mr-6">     
    <%= form_tag(consultant_list_counselings_path,method: :get) do %>
        <div class="md:grid md:grid-cols-7 gap-2 mb-5 items-center" style="grid-template-columns: auto 1fr 1fr 1fr 1fr 1fr 1fr;" >              
              <%= label_tag "期間", nil,class: " md:col-span-1 block text-sm font-medium text-gray-700" %>
              <%= select_tag(:aggregation_period, options_for_select([["Today","Today"],["7 Days", "7Days"],["15 Days","15Days"],["30 Days", "30Days"],["6 Months", "6Months"],["1 Year", "1Year"],["All","All"]],selected: @aggregation_period),class: "time-period px-2 md:col-span-1 focus:ring-indigo-500 focus:border-indigo-500 block shadow-sm sm:text-sm border-gray-300 rounded-md py-2") %>
        </div>
    <% end %>
     <%= form_tag(consultant_list_counselings_path,method: :get) do %>
      <div class=" ">
      <div class="md:grid-cols-8">
          <div class="">
           
           <div class="flex flex-wrap gap-2 mb-10 ">         
           <div class="col flex " style="width: 100%;max-width: calc(100%/4);align-self: center;" >
           <span style="max-width:150px;flex:150px;" >
           <%= label_tag "新患数", nil,class: "mt-3  block text-sm font-medium text-gray-700 mr-2 w-full"  %>
           </span>
           <div class="in-wrap" style="width: 100%;max-width: calc(100% - 150px);flex:calc(100% - 150px);" >
          <%= search_field_tag :no_of_cases, "",value: params[:no_of_cases], class:"w-full mt-1 focus:ring-indigo-500 focus:border-indigo-500 block shadow-sm sm:text-sm border-gray-300 rounded-md w-full",placeholder: '' %>
          </div>
         
           </div>

          <div class="col flex" style="width: 100%;max-width: calc(100%/4);align-self: center;">
          <span style="max-width:150px;flex:150px;" >
           <%= label_tag "再初診", nil,class: "mt-3 md:col-span-1 block text-sm font-medium text-gray-700 mr-2" %>
           </span>
            <div class="in-wrap" style="width: 100%;max-width: calc(100% - 150px);flex:calc(100% - 150px);" >
           <%= search_field_tag :re_first_visit, "",value: params[:re_first_visit], class:"w-full mt-1 focus:ring-indigo-500 focus:border-indigo-500 block shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder: '' %>
           </div>
          </div>
          
          <div class="col flex" style="width: 100%;max-width: calc(100%/4);align-self: center;">
            <span style="max-width:150px;flex:150px;" >
           <%= label_tag "新患+再初診 ", nil,class: "mt-3 md:col-span-1 block text-sm font-medium text-gray-700 mr-2" %>
           </span>
             <div class="in-wrap" style="width: 100%;max-width: calc(100% - 150px);flex:calc(100% - 150px);" >
           <%= search_field_tag :re_examination, "",value: params[:re_examination], class:"w-full mt-1 focus:ring-indigo-500 focus:border-indigo-500 block shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder: '' %>
            </div>
          </div>
          
          <div class="col flex" style="width: 100%;max-width: calc(100%/4);align-self: center;">
          <span style="max-width:150px;flex:150px;" >
           <%= label_tag "レセ枚数", nil,class: "mt-3 block text-sm font-medium text-gray-700 mr-2"  %>
           </span>
           <div class="in-wrap" style="width: 100%;max-width: calc(100% - 150px);flex:calc(100% - 150px);" >
           <%= search_field_tag :receipts, "",value: params[:receipts], class:"w-full mt-1 focus:ring-indigo-500 focus:border-indigo-500 block shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder: '' %>
          </div>
          </div>
           <div class="col flex" style="width: 100%;max-width: calc(100%/4);align-self: center;">
            <span style="max-width:150px;flex:150px;" >
             <%= label_tag "初診・再初診　コンサル率", nil,class: "mt-3  block text-sm font-medium text-gray-700 mr-2" %>
            </span>
            <div class="in-wrap" style="width: 100%;max-width: calc(100% - 150px);flex:calc(100% - 150px);" >
             <%= search_field_tag :first_re_first_rate, "",value: params[:first_re_first_rate], class:"w-full mt-1 focus:ring-indigo-500 focus:border-indigo-500 block shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder: '' %>
           </div>
           </div>
           <span style="max-width:200px;flex:200px;display:inline-block;margin-top:7px;">
             <%= submit_tag("検索", :id=>"button", :class=>"cursor-pointer active items-center px-4 py-2 border border-transparent  font-small rounded-md shadow-xl text-white bg-[#43c17a] hover:bg-green-500 w-full", :name=>"submit") %>
             </span>
             <span style="max-width:200px;flex:200px;display:inline-block;margin-top:16px;">
             <%= link_to "リセット", consultant_list_counselings_path, :class=>"col-span-1 active items-center px-4 py-2 border border-transparent  font-small rounded-md shadow-xl text-white bg-red-500 hover:bg-red-500 w-full" %>
           </span>
         </div>
           </div>
           
         </div>     
           
       </div>
     <% end %>

     <div class="flex flex-col">
          <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">          
            <div class="max-h-[600px]">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-[#fff] sticky top-0 z-10">
                  <tr>
                    <th scope="col" class="sticky left-0 bg-[#fff] z-2 px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" >担当者</th> <!-- Manager -->
                    <th scope="col" class="bg-[#fff] z-2 px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" colspan="2">初診 </th> <!-- First Visit-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" colspan="2" >再初診</th> <!-- Re-First Visit-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" rowspan="2" colspan="2" >セカンド</th> <!-- Second -->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" rowspan="2" colspan="2" >治療計画書</th> <!-- Treatment Plan-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" rowspan="2" colspan="2" >Pコンサル</th> <!-- P Consultant-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" rowspan="2" colspan="2" >検査③</th> <!-- Inspection 3 -->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" rowspan="2" colspan="2" >補綴</th> <!-- Prosthodontics-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" colspan="2" >義歯</th> <!-- Denture -->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" colspan="2" >ホワイトニング</th> <!-- Whitening-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" colspan="2" >インプラント</th> <!-- Implant -->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" colspan="2" >インビザライン</th> <!-- Invisalign-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" colspan="2" >他矯正</th> <!-- Other Correction-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" rowspan="2" colspan="2" >マイクロ</th> <!-- Micro -->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" rowspan="2" colspan="2" >メンテコンサル</th>
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" colspan="4" >口臭検査 </th> <!-- Bad Breath Test -->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" colspan="4" >顕微鏡</th> <!-- Microscope -->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center" colspan="4" >唾液</th> <!-- Saliva-->
                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center border-r-4" rowspan="2" >合計</th> <!-- Total -->
                  </tr>
                  <tr>
                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap text-center"  colspan="2" >説明</th> <!-- Explanation -->
                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" colspan="2">実施</th> <!-- Implementation -->
                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" colspan="2">説明</th> <!-- Explanation-->
                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" colspan="2">実施</th> <!-- Implementation-->
                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" colspan="2">説明</th> <!-- Explanation-->
                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-blackuppercase tracking-wider border border-l-4 whitespace-nowrap" colspan="2">実施</th> <!-- Implementation-->
                  </tr>
                </thead>
                    <tbody class="bg-blackdivide-y divide-gray-200">
                      <% data_available = 0 %>
                      <% @dentists.each do |dentist| %>
                        <% consultant_list(dentist.id,"DR") %>
                        <% data_available += 1 if @consultant.present? %>
                        <% if @consultant.present? %>
                        <tr>                       
                            <td class="sticky left-0 bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border border-l-4"><%= "DR #{dentist.full_name}" %></td>

                            <td class="bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border border-l-4" ><%= @first_visit %></td>
                            <td class="bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border" ><%= @first_visit_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @re_first_visit %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @re_first_visit_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @second_visit  %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @second_visit_rate  %></td>


                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @treat_plan %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @treat_plan_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @p_consult %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @p_consult_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @inspection %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @inspection_rate %></td>


                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @prostho %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @prostho_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @denture %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @denture_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @whitening %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @whitening_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @implant %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @implant_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @invisalign %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @invisalign_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%=  @other_correc %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%=  @other_correc_rate %></td>
                            
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @micro %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @micro_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @maintainance %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @maintainance_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @bad_breath_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @bad_breath_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @bad_breath_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @bad_breath_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @microscope_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @microscope_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @microscope_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @microscope_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @saliva_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @saliva_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @saliva_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @saliva_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= @total %></td>
                        </tr>
                        <% end %>
                      <% end %>

                      <!-- Dentist Hygienist -->
                      <% @dentist_hygienists.each do |dentist| %>
                        <% consultant_list(dentist.id,"DH") %>
                        <% data_available += 1 if @consultant.present? %>
                        <% if @consultant.present? %>
                        <tr>                       
                            <td class="sticky left-0 bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border border-l-4"><%= "DH #{dentist.full_name}" %></td>
                            <td class="bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border border-l-4" ><%= @first_visit %></td>
                            <td class="bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border" ><%= @first_visit_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @re_first_visit %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @re_first_visit_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @second_visit  %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @second_visit_rate  %></td>


                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @treat_plan %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @treat_plan_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @p_consult %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @p_consult_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @inspection %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @inspection_rate %></td>


                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @prostho %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @prostho_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @denture %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @denture_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @whitening %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @whitening_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @implant %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @implant_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @invisalign %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @invisalign_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%=  @other_correc %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%=  @other_correc_rate %></td>
                            
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @micro %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @micro_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @maintainance %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @maintainance_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @bad_breath_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @bad_breath_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @bad_breath_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @bad_breath_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @microscope_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @microscope_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @microscope_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @microscope_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @saliva_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @saliva_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @saliva_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @saliva_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= @total %></td>
                        </tr>
                        <% end %>
                      <% end %>

                      <!-- Treatment Coordinator -->
                      <% @treatment_coordinators.each do |dentist| %>
                        <% consultant_list(dentist.id,"TC") %>
                        <% data_available += 1 if @consultant.present? %>
                        <% if @consultant.present? %>
                        <tr>                       
                            <td class="sticky left-0 bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border border-l-4"><%= "TC #{dentist.full_name}" %></td>
                            <td class="bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border border-l-4" ><%= @first_visit %></td>
                            <td class="bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border" ><%= @first_visit_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @re_first_visit %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @re_first_visit_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @second_visit  %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @second_visit_rate  %></td>


                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @treat_plan %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @treat_plan_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @p_consult %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @p_consult_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @inspection %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @inspection_rate %></td>


                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @prostho %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @prostho_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @denture %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @denture_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @whitening %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @whitening_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @implant %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @implant_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @invisalign %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @invisalign_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%=  @other_correc %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%=  @other_correc_rate %></td>
                            
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @micro %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @micro_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @maintainance %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @maintainance_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @bad_breath_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @bad_breath_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @bad_breath_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @bad_breath_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @microscope_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @microscope_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @microscope_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @microscope_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @saliva_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @saliva_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @saliva_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @saliva_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= @total %></td>
                        </tr>
                        <% end %>
                      <% end %>
                    </tbody>
                    <tfoot>
                     <!-- Total -->
                    <% if data_available > 0 %>
                     <tr>
                      <th scope="col" class="sticky left-0 bg-white z-2 px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4">合計</th> <!-- Total-->
                          <% all %>
                            <td class="bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border border-l-4" ><%= @first_visit %></td>
                            <td class="bg-white z-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border" ><%= @first_visit_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @re_first_visit %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @re_first_visit_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @second_visit  %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @second_visit_rate  %></td>


                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @treat_plan %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @treat_plan_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @p_consult %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @p_consult_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @inspection %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @inspection_rate %></td>


                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @prostho %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @prostho_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @denture %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @denture_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @whitening %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @whitening_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @implant %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @implant_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @invisalign %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @invisalign_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%=  @other_correc %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%=  @other_correc_rate %></td>
                            
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @micro %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @micro_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 "><%= @maintainance %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border "><%= @maintainance_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @bad_breath_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @bad_breath_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @bad_breath_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @bad_breath_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @microscope_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @microscope_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @microscope_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @microscope_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @saliva_exp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @saliva_exp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @saliva_imp %></td>
                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border"><%= @saliva_imp_rate %></td>

                            <td class="text-center px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= %></td>
                     </tr>
                    <% else %>
                      <tr>
                          <td class="px-6 py-4 whitespace-nowrap text-sm text-red-500 text-center">結果が見つかりません！！</td> <!-- No Result Found !!-->
                      </tr>
                    <% end %>
                    </tfoot>
            </table>
        </div>
    </div>
</main>
<script>
    $(".time-period").on("change",function(){
        $("form").submit();
    });
</script>