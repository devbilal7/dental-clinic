 <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">          
                    <div class="max-h-[600px]">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-[#fff] sticky top-0 z-10">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4">No</th>
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4"><%= t("monthly.Full name") %></th>   
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4"></th> 
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4"><%= t("monthly.Course Unknown") %></th>    
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4">A</th>    
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4">B</th>    
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4">C</th>    
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4">D</th>    
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-black uppercase tracking-wider border border-l-4 border-r-4">E</th>    
                                </tr>
                            </thead>
                                <tbody class="bg-blackdivide-y divide-gray-200">
                                <tr>
                                <% i = 1%>
                                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4" rowspan="2"><%= i%></th>
                                    <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4" rowspan="2">全体</th>
                                    <% overall_courses %>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= t("monthly.Subject") %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @overall_unknown_course %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @overall_course_a %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @overall_course_b  %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @overall_course_c  %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @overall_course_d   %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= @overall_course_e   %></td> 
                                  </tr> 
                                  <tr>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4">%</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@overall_unknown_course.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@overall_course_a.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@overall_course_b.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@overall_course_c.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@overall_course_d.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= number_with_precision(@overall_course_e.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  </tr>
                                  <% @dentists.each_with_index do |dentist, index|  %>
                                    <% monthly_tabulation(dentist,"") %>
                                  <tr>
                                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4" rowspan="2"><%= i+1 %></th>
                                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4" rowspan="2"><%= "DR #{dentist.full_name}" %></th>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= t("monthly.Subject") %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @unknown_course %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_a %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_b %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_c  %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_d  %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= @course_e   %></td> 
                                  </tr> 
                                  <tr>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4">%</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%=  number_with_precision(@unknown_course.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%=  number_with_precision(@course_a.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_b.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_c.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_d.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= number_with_precision(@course_e.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  </tr>
                                  <% i = i+ 1%>
                                  <% end %>

                                  <% @dentist_hygienists.each_with_index do |dentist, index|  %>
                                    <% monthly_tabulation(dentist,"") %>
                                  <tr>
                                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4" rowspan="2"><%= i+=1 %></th>
                                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4" rowspan="2"><%= "DH #{dentist.full_name}" %></th>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= t("monthly.Subject") %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @unknown_course %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_a %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_b %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_c  %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_d  %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= @course_e   %></td> 
                                  </tr> 
                                  <tr>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4">%</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%=  number_with_precision(@unknown_course.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%=  number_with_precision(@course_a.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_b.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_c.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_d.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= number_with_precision(@course_e.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  </tr>
                                  </tr>  
                                  <% i+=1 %>
                                  <% end %>     
                                  <% @treatment_coordinators.each_with_index do |dentist, index|  %>
                                    <% monthly_tabulation(dentist,"") %>
                                  <tr>
                                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4" rowspan="2"><%= i %></th>
                                  <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border border-l-4" rowspan="2"><%= "TC #{dentist.full_name}" %></th>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= t("monthly.Subject") %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @unknown_course %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_a %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_b %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_c %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= @course_d %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= @course_e %></td> 
                                  </tr> 
                                  <tr>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4">%</td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%=  number_with_precision(@unknown_course.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%=  number_with_precision(@course_a.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_b.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_c.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4"><%= number_with_precision(@course_d.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 border border-l-4 border-r-4"><%= number_with_precision(@course_e.to_f/@number_of_new_cases.to_f,precision: 2) %></td>
                                  </tr>  
                                  <% i += 1 %>
                                  <% end %>                                    
                        </table>
                    </div>
                </div>